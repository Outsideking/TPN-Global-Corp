Repo: TGN-Web-App-Full

Frontend React + Backend FastAPI + PostgreSQL + SC/TPS Wallet Integration + CI/CD deploy-ready

-------------------

backend/main.py

-------------------

from fastapi import FastAPI, Depends, HTTPException from fastapi.middleware.cors import CORSMiddleware from fastapi.security import OAuth2PasswordRequestForm from auth import authenticate_user, create_access_token, get_current_user from wallet import get_balance, transfer_funds

app = FastAPI(title="TGN Web Full Backend")

CORS allow frontend

app.add_middleware( CORSMiddleware, allow_origins=[""] , allow_credentials=True, allow_methods=[""], allow_headers=["*"] )

Authentication

@app.post("/api/login") def login(form_data: OAuth2PasswordRequestForm = Depends()): user = authenticate_user(form_data.username, form_data.password) if not user: raise HTTPException(status_code=400, detail="Invalid credentials") token = create_access_token(user.username) return {"access_token": token, "token_type": "bearer"}

Protected API

@app.get("/api/dashboard") def dashboard(current_user: str = Depends(get_current_user)): balance = get_balance(current_user) return {"user": current_user, "balance": balance}

@app.post("/api/transfer") def transfer(amount: float, wallet_id: str, current_user: str = Depends(get_current_user)): result = transfer_funds(current_user, wallet_id, amount) return {"status": "success", "result": result}

Health check

@app.get("/api/hello") def hello(): return {"message": "Hello from TGN Web Full Backend"}

-------------------

backend/auth.py

-------------------

from datetime import datetime, timedelta from jose import JWTError, jwt from passlib.context import CryptContext

SECRET_KEY = "secret-tgn-key" ALGORITHM = "HS256" ACCESS_TOKEN_EXPIRE_MINUTES = 60

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto") fake_users_db = {"rufio": {"username": "rufio", "hashed_password": pwd_context.hash("password123")}}

Authenticate user

def authenticate_user(username: str, password: str): user = fake_users_db.get(username) if not user or not pwd_context.verify(password, user["hashed_password"]): return None return user

Create JWT token

def create_access_token(username: str): expire = datetime.utcnow() + timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES) to_encode = {"sub": username, "exp": expire} encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM) return encoded_jwt

Dependency to get current user

def get_current_user(token: str = Depends(lambda: None)): # Simple example, normally Depends(OAuth2PasswordBearer) would be used try: payload = jwt.decode(token or "", SECRET_KEY, algorithms=[ALGORITHM]) username: str = payload.get("sub") if username is None: raise Exception("Invalid token") return username except JWTError: raise Exception("Could not validate token")

-------------------

backend/wallet.py

-------------------

fake_wallet_db = {"rufio": 1000000}

Get user balance

def get_balance(username: str): return fake_wallet_db.get(username, 0)

Transfer funds

def transfer_funds(sender: str, wallet_id: str, amount: float): balance = get_balance(sender) if balance < amount: raise Exception("Insufficient funds") fake_wallet_db[sender] -= amount # Simulate transfer to wallet_id (SC/TPS API integration can be added here) return f"Transferred {amount} to wallet {wallet_id}"

-------------------

backend/requirements.txt

-------------------

""" fastapi uvicorn python-jose passlib[bcrypt] requests psycopg2-binary """

-------------------

frontend/src/App.js

-------------------

""" import React, { useState } from 'react';

function App() { const [message, setMessage] = useState('');

const callHello = async () => { const res = await fetch('http://localhost:8000/api/hello'); const data = await res.json(); setMessage(data.message); };

return ( <div> <h1>TGN Web Full App</h1> <button onClick={callHello}>Call Backend</button> <p>{message}</p> </div> ); }

export default App; """

-------------------

.github/workflows/backend-deploy.yml

-------------------

""" name: Deploy TGN Backend on: [push] jobs: deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v3 - name: Setup Python uses: actions/setup-python@v4 with: python-version: '3.11' - run: pip install -r backend/requirements.txt - name: Deploy uses: easingthemes/ssh-deploy@v2.0.7 with: ssh-private-key: ${{ secrets.SERVER_SSH_KEY }} server-ip: ${{ secrets.SERVER_IP }} remote-path: /home/tgn/web-backend local-path: backend/ """

-------------------

.github/workflows/frontend-deploy.yml

-------------------

""" name: Deploy TGN Frontend on: [push] jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v3 - name: Setup Node uses: actions/setup-node@v3 with: node-version: '20' - run: npm install --prefix frontend - run: npm run build --prefix frontend - name: Deploy uses: easingthemes/ssh-deploy@v2.0.7 with: ssh-private-key: ${{ secrets.SERVER_SSH_KEY }} server-ip: ${{ secrets.SERVER_IP }} remote-path: /home/tgn/web-frontend local-path: frontend/build """
